import mockData from"./mock-data";export const extractLocations=events=>{const extractedLocations=events.map((event=>event.location));return[...new Set(extractedLocations)]};const checkToken=async accessToken=>{const response=await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`);return await response.json()},removeQuery=()=>{let newurl;window.history.pushState&&window.location.pathname?(newurl=window.location.protocol+"//"+window.location.host+window.location.pathname,window.history.pushState("","",newurl)):(newurl=window.location.protocol+"//"+window.location.host,window.history.pushState("","",newurl))};export const getEvents=async()=>{if(window.location.href.startsWith("http://localhost"))return mockData;const token=await getAccessToken();if(token){removeQuery();const url="https://ymaled62u1.execute-api.eu-central-1.amazonaws.com/dev/api/get-events/"+token,response=await fetch(url),result=await response.json();return result?result.events:null}};export const getAccessToken=async()=>{const accessToken=localStorage.getItem("access_token"),tokenCheck=accessToken&&await checkToken(accessToken);if(!accessToken||tokenCheck.error){await localStorage.removeItem("access_token");const searchParams=new URLSearchParams(window.location.search),code=await searchParams.get("code");if(!code){const response=await fetch("https://ymaled62u1.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url"),result=await response.json(),{authUrl:authUrl}=result;return window.location.href=authUrl}return code&&getToken(code)}return accessToken};const getToken=async code=>{const encodeCode=encodeURIComponent(code),response=await fetch("https://ymaled62u1.execute-api.eu-central-1.amazonaws.com/dev/api/token/"+encodeCode),{access_token:access_token}=await response.json();return access_token&&localStorage.setItem("access_token",access_token),access_token};